import mysql.connector

#Connection Establishment
mydb = mysql.connector.connect(
  host="localhost",
  user="root",
  password="shyam",
  database="mydatabase"
)

#Creating Table Movie
mycursor = mydb.cursor()
mycursor.execute("create table Movies(name varchar(30),actor varchar(30),actress varchar(30),year integer(5),director varchar(30))")

#Inserting Values
sql = "INSERT INTO Movies(name,actor,actress,year,director) VALUES (%s,%s,%s, %s,%s)"
val = [("Beast","Vijay","Pooja Hegde","2022","Nelson"),("Valimai","Ajith Kumar","Huma Qureshi","2022","Prabhu"),("Maanaadu","Silambarasan","Kalyani Priyadarshan","2021","Venkat Prabhu"),("Nanban","Vijay","Illeana","2011","Shankar"),("Veeram","Ajith","Thamana","2015","Siva")]
mycursor.executemany(sql,val)

#Retrieving all rows from table
query="SELECT * FROM Movies"
mycursor.execute(query)
result=mycursor.fetchall()
for i in result:
    print(i)
    
#Retrieving rows where actor name is 'Vijay'
mycur=mydb.cursor()
query1="SELECT * FROM Movies where actor='Vijay'"
mycur.execute(query1)
result1=mycur.fetchall()
for j in result1:
    print(j)
mydb.commit()
